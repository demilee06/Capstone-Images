var klevu_voiceSearch={options:{micImage:"https://js.klevu.com/klevu-js-v1/img-1-1/speech.png",micAnimationImage:"https://js.klevu.com/klevu-js-v1/img-1-1/mic-animate.gif",voiceSearchPlaceholder:"Listening..."},isBrowserSupported:function(b){var a="0";if(b.indexOf("Chrome")>-1&&b.indexOf("Edge")<0){a=b.substring(b.indexOf("Chrome/")+7);a=a.substring(0,a.indexOf("."))}return(+(a)>=26)},startVoiceDictation:function(e){var d=klevu_voiceSearch.options.micImage,c=klevu_voiceSearch.options.micAnimationImage,a=klevu_voiceSearch.options.voiceSearchPlaceholder,g=e.nextElementSibling,f=g.placeholder,b=new webkitSpeechRecognition();b.continuous=false;b.interimResults=true;b.start();b.onstart=function(){g.placeholder=a;g.value="";g.focus();recognizing=true;e.src=c};b.onresult=function(m){var k=m.results,l="",h,j;for(j=m.resultIndex;j<k.length;++j){h=k[j];if(h.isFinal){l=k[0][0].transcript;b.stop();g.value=l;g.dispatchEvent(new Event("keyup"))}else{l+=h[0].transcript}}g.value=l};b.onspeechend=function(h){e.src=d;g.placeholder=f};b.onerror=function(h){if(h.error==="no-speech"){e.src=d}if(h.error==="audio-capture"){e.src=d}b.stop()};b.onend=function(){e.src=d;g.placeholder=f}},init:function(c){if("undefined"!==typeof klevu_layout){for(objectKey in c){if(c.hasOwnProperty(objectKey)){klevu_voiceSearch.options[objectKey]=c[objectKey]}}if(klevu_voiceSearch.isBrowserSupported(window.navigator.userAgent)===true&&window.hasOwnProperty("webkitSpeechRecognition")){var b,d=document.getElementsByTagName("input"),a;for(a=0,len=d.length;a<len;a++){if(d[a].type==="text"||d[a].type==="search"){if(d[a].name==="q"||d[a].id===searchTextBoxName){b=document.createElement("img");b.setAttribute("name","klevuVoiceSearchImage");b.setAttribute("alt","Search by Voice");b.setAttribute("title","Search by Voice");b.setAttribute("class","klevuVoiceSearchImage");b.setAttribute("onclick","klevu_voiceSearch.startVoiceDictation(this)");b.setAttribute("src",klevu_voiceSearch.options.micImage);b.id="kvsi-"+a;d[a].before(b)}}}}}else{setTimeout(function(){klevu_voiceSearch.init(c)},200)}}};
if("undefined"==typeof sfdrUniqid&&(sfdrUniqid=function(){let a=new Date().valueOf(),b=a.toString(),c="",d=0,e="0123456789abcdef";for(let a=16;0<a;--a)c+=1&a&&b.charAt(d)?b.charAt(d):e[Math.floor(Math.random()*e.length)],1&a&&d++;return c}),"undefined"==typeof sfdrGetCookie&&(sfdrGetCookie=function(a){let b=a+"=",c=decodeURIComponent(document.cookie),d=c.split(";");for(let e,c=0;c<d.length;c++){for(e=d[c];" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return""}),"undefined"==typeof sfdrSetCookie&&(sfdrSetCookie=function(a,b,c){if(("undefined"==typeof sfdrplatform||"shopify"===sfdrplatform)&&"undefined"!=typeof Shopify){let d=sessionStorage.getItem("sfdrcookiepermission");if(d&&"true"==d){let e=new Date;e.setTime(e.getTime()+1e3*(60*(60*(24*c))));let d="expires="+e.toUTCString();document.cookie=a+"="+b+";"+d+";path=/"}}else{let e=new Date;e.setTime(e.getTime()+1e3*(60*(60*(24*c))));let d="expires="+e.toUTCString();document.cookie=a+"="+b+";"+d+";path=/"}}),"undefined"==typeof sfdrGetParam&&(sfdrGetParam=function(a){let b=RegExp("[?&]"+a+"=([^&]*)").exec(window.location.search);return b&&decodeURIComponent(b[1].replace(/\+/g," "))}),"undefined"==typeof sfdrGetJSParams&&(sfdrGetJSParams=function(a){for(var b=document.getElementsByTagName("script"),c=0;c<b.length;c++)if(-1<b[c].src.indexOf("/"+a)){for(var d,e=b[c].src.split("?").pop().split("&"),f={},g=0;g<e.length;g++)d=e[g].split("="),f[d[0]]=d[1];return f}return{}}),"undefined"==typeof sfdr_orig_cookie){let a,b=sfdrGetParam("SFDRREF"),c=sfdrGetParam("ref"),d="shoppingfeeder",e="_sfdr_ref_ptcid",f="_sfdr_ref_gclid",g="_sfdr_clid",h="",j=sfdrGetParam("sfdr_ptcid"),k=sfdrGetJSParams("sfdr.js"),l=null;if(document.getElementById("sfdr_js")&&(a=document.getElementById("sfdr_js").getAttribute("data-platform")),(/\/checkout\/onepage\/success/.exec(window.location)||/mage2.html/.exec(window.location))&&(a="magento2"),!a&&k&&{}!==k&&k.platform&&""!==k.platform&&(a=k.platform),k&&{}!==k&&k.sfdr_env&&""!==k.sfdr_env&&(h=k.sfdr_env),("undefined"==typeof a||"shopify"===a)&&"undefined"!=typeof Shopify)if(sfdrcookiepermission=sessionStorage.getItem("sfdrcookiepermission"),window.Shopify.customerPrivacy){let a=window.Shopify.customerPrivacy.userCanBeTracked();sfdrcookiepermission=a,sessionStorage.setItem("sfdrcookiepermission",a)}else window.Shopify.loadFeatures&&window.Shopify.loadFeatures([{name:"consent-tracking-api",version:"0.1"}],a=>{let b=window.Shopify.customerPrivacy.userCanBeTracked();sfdrcookiepermission=b,sessionStorage.setItem("sfdrcookiepermission",b)});let m=sfdrGetCookie(d);m&&""!==m||(m=sfdrUniqid(),sfdrSetCookie(d,m,7300));let n=sfdrGetCookie("SFDRREF");if((!n||""===n)&&b&&""!==b&&sfdrSetCookie("SFDRREF",b,7300),c&&""!==c&&c.match(/SFDR_/i)&&sfdrSetCookie(g,c,7300),j){sfdrSetCookie(e,j,90);let b=sfdrGetParam("gclid");b||(b=sfdrGetParam("srsltid"));let c=sfdrGetParam("msclkid"),d=sfdrGetParam("fbclid");if(b){sfdrSetCookie(f,b,90);let c="";c+="&ptid="+b,j&&(c+="&ptcid="+j);let d=sfdrGetParam("sfdr_hash");if(d&&(c+="&hash="+d),document.referrer&&(c+="&referrer="+encodeURI(document.referrer)),("undefined"==typeof a||"shopify"===a)&&"undefined"!=typeof Shopify){let a=sessionStorage.getItem("sfdrcookiepermission");if(a&&"true"===a){let a=new Image;a.src="https://sfdr.co/store-track?ignore_redirect=1"+c}}else{let a=new Image;a.src="https://sfdr.co/store-track?ignore_redirect=1"+c}}else if(c){sfdrSetCookie(f,c,90);let b="";b+="&ptid="+c,j&&(b+="&ptcid="+j);let d=sfdrGetParam("sfdr_hash");if(d&&(b+="&hash="+d),document.referrer&&(b+="&referrer="+encodeURI(document.referrer)),("undefined"==typeof a||"shopify"===a)&&"undefined"!=typeof Shopify){let a=sessionStorage.getItem("sfdrcookiepermission");if(a&&"true"===a){let a=new Image;a.src="https://sfdr.co/store-track?ignore_redirect=1"+b}}else{let a=new Image;a.src="https://sfdr.co/store-track?ignore_redirect=1"+b}}else if(d){sfdrSetCookie(f,d,90);let b="";b+="&ptid="+d,j&&(b+="&ptcid="+j);let c=sfdrGetParam("sfdr_hash");if(c&&(b+="&hash="+c),document.referrer&&(b+="&referrer="+encodeURI(document.referrer)),("undefined"==typeof a||"shopify"===a)&&"undefined"!=typeof Shopify){let a=sessionStorage.getItem("sfdrcookiepermission");if(a&&"true"===a){let a=new Image;a.src="https://sfdr.co/store-track?ignore_redirect=1"+b}}else{let a=new Image;a.src="https://sfdr.co/store-track?ignore_redirect=1"+b}}}if(("undefined"==typeof a||"shopify"===a)&&"undefined"!=typeof Shopify&&"undefined"!=typeof Shopify.checkout&&"true"===sfdrcookiepermission){let a=sfdrGetCookie(f),b=sfdrGetCookie(e),c=sfdrGetCookie(g),d=Shopify.checkout;if(k&&{}!==k&&k.sid&&""!==k.sid&&(l=k.sid),b){let c=b.split("_");c&&c[0]&&(a&&(d.landing_site_ref="SFDR_PT__"+a),(!l||""===l)&&(l=c[0]))}else c&&""!==c&&(d.landing_site_ref=c);Shopify.checkout.order_id&&(d.id=Shopify.checkout.order_id),Shopify.checkout.subtotal_price&&(d.total_line_items_price=Shopify.checkout.subtotal_price),Shopify.checkout.discount&&(d.total_discounts=Shopify.checkout.discount),m&&(d.uid=m),xhr=new XMLHttpRequest;let h="https://sfdr.co/webhook/shopify-orders?store_id="+l;xhr.open("POST",h,!0),xhr.setRequestHeader("Content-type","text/plain");let i=JSON.stringify(d);xhr.send(i)}else if(a&&"magento2"===a&&"undefined"!=typeof dataLayer){let a=sfdrGetCookie(f),b=sfdrGetCookie(e),c=sfdrGetCookie(g),d={};if(k&&{}!==k&&k.sid&&""!==k.sid&&(l=k.sid),b){let c=b.split("_");c&&c[0]&&(a&&(d.landing_site_ref="SFDR_PT__"+a),(!l||""===l)&&(l=c[0]))}for(var i=0;i<dataLayer.length;i++)if(dataLayer[i]&&dataLayer[i].event&&dataLayer[i].ecommerce&&"purchase"===dataLayer[i].event&&dataLayer[i].ecommerce.purchase&&dataLayer[i].ecommerce.purchase.actionField){var sfdrOrderData=dataLayer[i].ecommerce.purchase;if(dataLayer[i].ecommerce.currencyCode&&(d.currency=dataLayer[i].ecommerce.currencyCode),sfdrOrderData.products){d.line_items=[];for(var p=0;p<sfdrOrderData.products.length;p++)d.line_items[p]=sfdrOrderData.products[p],d.line_items[p].sku=sfdrOrderData.products[p].id,delete d.line_items[p].id}sfdrOrderData.actionField.id&&(d.increment_id=sfdrOrderData.actionField.id),sfdrOrderData.actionField.revenue&&(d.total_line_items_price=sfdrOrderData.actionField.revenue),sfdrOrderData.actionField.discount&&(d.total_discounts=sfdrOrderData.actionField.discount),m&&(d.uid=m),xhr=new XMLHttpRequest;let a="https://sfdr.co/webhook/magento2-orders?store_id="+l;xhr.open("POST",a,!0),xhr.setRequestHeader("Content-type","text/plain");let b=JSON.stringify(d);xhr.send(b);break}}else if(a&&"prestashop"===a&&"undefined"!=typeof dataLayer){let a=sfdrGetCookie(e);if(a){let b=a.split("_");b&&b[0]&&(!l||""===l)&&(l=b[0])}for(var shoppingfeederOrderData="",i=0;i<dataLayer.length;i++)dataLayer[i]&&dataLayer[i].shoppingfeederOrderData&&(shoppingfeederOrderData=dataLayer[i].shoppingfeederOrderData);if(shoppingfeederOrderData&&""!==shoppingfeederOrderData){xhr=new XMLHttpRequest;let a="https://sfdr.co/webhook/prestashop-orders?store_id="+l;xhr.open("POST",a,!0),xhr.setRequestHeader("Content-type","text/plain");let b=JSON.stringify(shoppingfeederOrderData);xhr.send(b)}}else{var current_gclid=sfdrGetCookie(f);!current_gclid.match(/UID_/i)&&current_gclid&&m&&(current_gclid="UID_"+m+"_"+current_gclid,sfdrSetCookie(f,current_gclid,90))}}